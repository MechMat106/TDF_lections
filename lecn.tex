\section{Лекция 7 (продолжение оценки функции Шеннона).} 
\subsection{В предыдущих сериях}
Мы уже имеем для функции Шеннона следующую оценку скорости роста:
%Надо заменить значки меньше или равно на меньше илит эквивалентноы
$$n\leq L(n)\leq 6\cdot \frac{2^n}{n}$$
Попробуем теперь ее улучшить.\\
Напомним, что:
\begin{definition}
Приведенная схема --- схема, в которой все элементы выполняют разные функции, то есть не существует таких двух одинаковых элементов, на входы которых подаются одни и те же переменные или результаты вычисления других функций.
\end{definition}
%\textit{Заметим, что в данном определении под разными функциями понимаются неравные функции, либо равные функции, действующие на разном наборе переменных.}\\
Все булевы функции в этой лекции будем считать от переменных $\XXX$. Также все выкладки проводятся в выбранном <<стандартном>> базисе $\{\& ,\vee ,\neg\}$, если не указано обратное.
\subsection{Определения.}
\begin{definition}
$N_{=(n,l)}$ --- число приведенных схем сложности $l$ со входами $\XXX$.
\end{definition}
\begin{definition}
$N_{\leq(n,l)}$ --- число приведенных схем сложности не выше $l$ со входами $\XXX$.
\end{definition}
\subsection{Основная оценка.}
\begin{lemma}
При достаточно больших $n$ при $l\geq n \:\: \exists \, C>0$ выполняется неравенство\\
$$N_{\leq(n,l)}\leq (C\cdot l)^l $$
\end{lemma}
Пусть $S$ --- приведенная схема сложности $l$ со входами $\XXX$.
Пронумеруем элементы схемы и зафиксируем нумерацию $Num$. Пусть $L_i$ --- элемент схемы, имеющий в данной нумерации номер $i$. На множестве пар из схемы и нумерации на ней введем функцию
$t(S,Num)= T$%(аргумент функции --- пара $(S,Num)$, а значение --- \textit{таблица} $T$)
, где $T$ --- таблица вида:
$$
    \begin{array}{|c|c|c|}
    \hline
       f & E_1 & E_2 \\
      \hline
       \& & x_1 & x_3 \\
      \hline
       \vee & x_1 & x_3 \\
       \hline
       \neg & x_2 & x_2 \\
       \hline
     \vee & x_2 & L_2 \\
     \hline
      \& & L_6 & L_4\\
    \hline
    \vee & L_1 & L_3\\
    \hline
    \end{array}
    $$
Таблица состоит из $l$ строк и трёх столбцов, в строчке с номером $i$ в первом столбце стоит знак функции, которую реализует элемент $L_i$, a в двух других --- элементы множества $\{ L_1,\ldots,L_l, \XXX\} $, которые поступают на вход этой функции. %Это могут быть переменные или <<выходы>>  других элементов. %Иначе, $e_1,\,e_2\, \in \{ L_1,\ldots,L_l, \XXX\} $. 
Если функция в левом столбце --- отрицание, в два правых столбца запишем один и тот же элемент из вышеуказанного множества, над которым производится отрицание. Например, на схеме, задаваемой таблицей выше, переменные $x_1$ и $x_3$ передаются на элемент <<и>> (первая строчка), результат передаётся вместе с отрицанием переменной $x_2$ на вход элемента <<или>> (шестая строчка) и т.д. Также обозначим за $a$ номер строки с элементом, выход которого является выходом всей схемы (тут $a=5$). \\
По такой таблице, построенной по схеме и нумерации, можно однозначно восстановить схему $S$.\\
%Оценим число таблиц, соответствующих всем парам $(S,Num)$ заданной сложности $l$. Обозначим его $N_{l}$.\\
Обозначим за $N_l$ число таблиц, соответствующих всем парам $(S,Num)$ заданной сложности $l$. Имеет место оценка
$$ N_l\leq 3^l\cdot (l+n)^{2l} \cdot l \leq 3^l \cdot 2l^{2l}\cdot l = (3\cdot 2^2)^l\cdot l^{2l}\cdot l = 12^l \cdot l^{2l} \cdot l \leq 13^l\cdot l^{2l}.$$

Первое неравенство очевидно. Второе неравенство следует из предположения $n\leq l$, при котором мы доказываем лемму. Последнее неравенство верно асимптотически и следует из неравенства $12^l\cdot l\leq 13^l$.
\begin{statement}
Пусть схема $S$ --- приведенная, $Num_1 \neq Num_2$ --- две ее нумерации, $t(S, Num_1)= T_1$;  $t(S, Num_2)= T_2$, тогда $T_1 \neq T_2$
\end{statement}
\begin{proof}
%Здесь остановили редактирование вечером 26го марта.
Предположим, что $T_1 = T_2$.

Введем на $S$ еще одну монотонную нумерацию $Num_0$ и зафиксируем ее. Дальше, перебирая по порядку нумерации $Num_0$ элементы схемы $S$ найдем первый элемент $L_i$ (по нумерации $Num_0$), такой, что он имеет в $Num_1$ и $Num_2$ номера $k_1$ и $k_2$, причем $k_1 \neq k_2$. Такой элемент существует, потому что $Num_1 \neq Num_2$. Рассмотрим строки $k_1$ и $k_2$ таблиц $T_1$ и $T_2$ соответственно. 

В первой их клетке стоит один и тот же знак, так как функция, которую реализует элемент, не зависит от нумерации. Для двух других клеток есть две возможности: либо там стоит знак переменной, тогда они тоже одинаковы, либо элемент множества $\{ L_1 \cdots L_l\} $, для каждой таблицы в своей нумерации. \\
Посмотрим, <<выход>> каких элементов может подаваться на <<вход>> элемента $L_i$ (в нумерации $Num_0$). Так как $Num_0$ --- монотонная, то  это могут быть только элементы с меньшим номером в данной операции.  Но для элементов с меньшим номером в $Num_0$ их номера в $Num_1$ и $Num_2$ совпадают. \\
Это значит, что строчки $k_1$ в $T_1$ и $k_2$ в $T_2$ одинаковые. Так как таблицы (по нашему предположению) одинаковые, то в таблице $T_1$ строчка c номером $k_2 \neq k_1$ совпадает со строчкой с тем же номером в $T_2$, которая, в свою очередь, совпадает со строчкой $k_1$ в $T_1$. Это значит, что в $T_1$ есть две одинаковые строчки. Другими словами, в схеме $S$ есть два элемента, реализующие одинаковые функции. Это противоречит с приведенностью $S$.\\
Итак, $T_1 \neq T_2$
\end{proof}
Значит, число таблиц, соответствующей какой-либо схеме равно числу способов пронумеровать элементы этой схемы.
Тогда, учитывая, что число способов пронумеровать $l$ элементов --- $l!$, и что $l! \geq (\frac{l}{3})^l $:\\
$$ N_{=(n,l)}=\frac{N_l}{l!} \leq \frac{13^l\cdot l^{2l}}{l!} \leq 39^l\cdot l^l $$\\
Тогда:
$$N_{\leq(n,l)} \leq \sum _{i=0} ^{l} N_{=(n,i)} \leq (l+1)\cdot 39^l \cdot l^l \leq (40l)^l$$
Данная оценка завершает доказательство леммы.
\begin{statement}
$$L(n) \geq \frac{2^n}{n}$$
\end{statement}
\begin{proof}
Положим $l_\varepsilon = (1-\varepsilon)\cdot \frac{2^n}{n}$, $0 < \varepsilon < 1$\\
При любом $\varepsilon$ из заданного интервала верна оценка:
$$ \log_2{\frac{N_{\leq(n,l_\varepsilon)}}{2^{2^n}} } \leq l_\varepsilon \cdot \log_2 {(C\cdot l_\varepsilon)} - 2^n \leq (1-\varepsilon)\cdot \frac{2^n}{n} \cdot \log_2 {2^n} - 2^n = -\varepsilon \cdot \frac{2^n}{n}$$
При $n \rightarrow +\infty$ отношение $\cfrac{N_{\leq(n,l_\varepsilon)}}{2^{2^n}} \;$ стремится к нулю.\\

Это значит, что при достаточно больших $n$ число функций, которые можно реализовать при помощи схем, сложности меньше $\frac{2^n}{n}\,$, много меньше числа всех функций от $n$ переменных. А это значит, что существуют функции, сложность которых больше или равна $\frac{2^n}{n}\,$. А это и значит, что 
$$L(n) \geq \frac{2^n}{n}$$
\end{proof}
